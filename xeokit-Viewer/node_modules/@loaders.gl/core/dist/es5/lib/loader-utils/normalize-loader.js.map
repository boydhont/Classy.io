{"version":3,"file":"normalize-loader.js","names":["_loaderUtils","require","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty2","default","getOwnPropertyDescriptors","defineProperties","defineProperty","isLoaderObject","loader","_loader","Array","isArray","hasExtensions","extensions","normalizeLoader","_loader2","_loader3","assert","options","parseTextSync","parseText","text","binary"],"sources":["../../../../src/lib/loader-utils/normalize-loader.ts"],"sourcesContent":["import type {Loader} from '@loaders.gl/loader-utils';\nimport {assert} from '@loaders.gl/loader-utils';\n\nexport function isLoaderObject(loader?: any): boolean {\n  if (!loader) {\n    return false;\n  }\n\n  if (Array.isArray(loader)) {\n    loader = loader[0];\n  }\n\n  const hasExtensions = Array.isArray(loader?.extensions);\n\n  /* Now handled by types and worker loaders do not have these\n  let hasParser =\n    loader.parseTextSync ||\n    loader.parseSync ||\n    loader.parse ||\n    loader.parseStream || // TODO Remove, Replace with parseInBatches\n    loader.parseInBatches;\n  */\n\n  return hasExtensions;\n}\n\nexport function normalizeLoader(loader: Loader): Loader {\n  // This error is fairly easy to trigger by mixing up import statements etc\n  // So we make an exception and add a developer error message for this case\n  // To help new users from getting stuck here\n  assert(loader, 'null loader');\n  assert(isLoaderObject(loader), 'invalid loader');\n\n  // NORMALIZE [LOADER, OPTIONS] => LOADER\n\n  // If [loader, options], create a new loaders object with options merged in\n  let options;\n  if (Array.isArray(loader)) {\n    options = loader[1];\n    loader = loader[0];\n    loader = {\n      ...loader,\n      options: {...loader.options, ...options}\n    };\n  }\n\n  // NORMALIZE text and binary flags\n  // Ensure at least one of text/binary flags are properly set\n\n  // @ts-expect-error\n  if (loader?.parseTextSync || loader?.parseText) {\n    loader.text = true;\n  }\n\n  if (!loader.text) {\n    loader.binary = true;\n  }\n\n  return loader;\n}\n"],"mappings":";;;;;;;;;AACA,IAAAA,YAAA,GAAAC,OAAA;AAAgD,SAAAC,QAAAC,MAAA,EAAAC,cAAA,QAAAC,IAAA,GAAAC,MAAA,CAAAD,IAAA,CAAAF,MAAA,OAAAG,MAAA,CAAAC,qBAAA,QAAAC,OAAA,GAAAF,MAAA,CAAAC,qBAAA,CAAAJ,MAAA,GAAAC,cAAA,KAAAI,OAAA,GAAAA,OAAA,CAAAC,MAAA,WAAAC,GAAA,WAAAJ,MAAA,CAAAK,wBAAA,CAAAR,MAAA,EAAAO,GAAA,EAAAE,UAAA,OAAAP,IAAA,CAAAQ,IAAA,CAAAC,KAAA,CAAAT,IAAA,EAAAG,OAAA,YAAAH,IAAA;AAAA,SAAAU,cAAAC,MAAA,aAAAC,CAAA,MAAAA,CAAA,GAAAC,SAAA,CAAAC,MAAA,EAAAF,CAAA,UAAAG,MAAA,WAAAF,SAAA,CAAAD,CAAA,IAAAC,SAAA,CAAAD,CAAA,QAAAA,CAAA,OAAAf,OAAA,CAAAI,MAAA,CAAAc,MAAA,OAAAC,OAAA,WAAAC,GAAA,QAAAC,gBAAA,CAAAC,OAAA,EAAAR,MAAA,EAAAM,GAAA,EAAAF,MAAA,CAAAE,GAAA,SAAAhB,MAAA,CAAAmB,yBAAA,GAAAnB,MAAA,CAAAoB,gBAAA,CAAAV,MAAA,EAAAV,MAAA,CAAAmB,yBAAA,CAAAL,MAAA,KAAAlB,OAAA,CAAAI,MAAA,CAAAc,MAAA,GAAAC,OAAA,WAAAC,GAAA,IAAAhB,MAAA,CAAAqB,cAAA,CAAAX,MAAA,EAAAM,GAAA,EAAAhB,MAAA,CAAAK,wBAAA,CAAAS,MAAA,EAAAE,GAAA,iBAAAN,MAAA;AAEzC,SAASY,cAAcA,CAACC,MAAY,EAAW;EAAA,IAAAC,OAAA;EACpD,IAAI,CAACD,MAAM,EAAE;IACX,OAAO,KAAK;EACd;EAEA,IAAIE,KAAK,CAACC,OAAO,CAACH,MAAM,CAAC,EAAE;IACzBA,MAAM,GAAGA,MAAM,CAAC,CAAC,CAAC;EACpB;EAEA,IAAMI,aAAa,GAAGF,KAAK,CAACC,OAAO,EAAAF,OAAA,GAACD,MAAM,cAAAC,OAAA,uBAANA,OAAA,CAAQI,UAAU,CAAC;EAWvD,OAAOD,aAAa;AACtB;AAEO,SAASE,eAAeA,CAACN,MAAc,EAAU;EAAA,IAAAO,QAAA,EAAAC,QAAA;EAItD,IAAAC,mBAAM,EAACT,MAAM,EAAE,aAAa,CAAC;EAC7B,IAAAS,mBAAM,EAACV,cAAc,CAACC,MAAM,CAAC,EAAE,gBAAgB,CAAC;EAKhD,IAAIU,OAAO;EACX,IAAIR,KAAK,CAACC,OAAO,CAACH,MAAM,CAAC,EAAE;IACzBU,OAAO,GAAGV,MAAM,CAAC,CAAC,CAAC;IACnBA,MAAM,GAAGA,MAAM,CAAC,CAAC,CAAC;IAClBA,MAAM,GAAAd,aAAA,CAAAA,aAAA,KACDc,MAAM;MACTU,OAAO,EAAAxB,aAAA,CAAAA,aAAA,KAAMc,MAAM,CAACU,OAAO,GAAKA,OAAO;IAAC,EACzC;EACH;EAMA,IAAI,CAAAH,QAAA,GAAAP,MAAM,cAAAO,QAAA,eAANA,QAAA,CAAQI,aAAa,KAAAH,QAAA,GAAIR,MAAM,cAAAQ,QAAA,eAANA,QAAA,CAAQI,SAAS,EAAE;IAC9CZ,MAAM,CAACa,IAAI,GAAG,IAAI;EACpB;EAEA,IAAI,CAACb,MAAM,CAACa,IAAI,EAAE;IAChBb,MAAM,CAACc,MAAM,GAAG,IAAI;EACtB;EAEA,OAAOd,MAAM;AACf"}