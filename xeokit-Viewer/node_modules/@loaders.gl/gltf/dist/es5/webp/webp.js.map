{"version":3,"file":"webp.js","names":["WEBP_TEST_IMAGES","lossy","lossless","alpha","animation","WEBP_FEATURES","isWebPSupported","_isWebPSupported","apply","arguments","_asyncToGenerator2","default","_regenerator","mark","_callee","features","promises","statuses","_args","wrap","_callee$","_context","prev","next","length","undefined","map","feature","checkWebPFeature","Promise","all","sent","abrupt","every","_","stop","_x","_checkWebPFeature","_callee2","_callee2$","_context2","Image","resolve","reject","img","onload","width","height","onerror","src","concat"],"sources":["../../../src/webp/webp.ts"],"sourcesContent":["const WEBP_TEST_IMAGES = {\n  lossy: 'UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA',\n  lossless: 'UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==',\n  alpha:\n    'UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==',\n  animation:\n    'UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA'\n};\n\nexport type WebPFeature = 'lossy' | 'lossless' | 'alpha' | 'animation';\n\nconst WEBP_FEATURES: WebPFeature[] = ['lossy', 'lossless', 'alpha', 'animation'];\n\n/**\n * Checks if WebP is supported\n * @param features Array, can include 'lossy', 'lossless', 'alpha' or 'animation'\n */\nexport async function isWebPSupported(features: WebPFeature[] = WEBP_FEATURES): Promise<boolean> {\n  const promises = features.map((feature) => checkWebPFeature(feature));\n  const statuses = await Promise.all(promises);\n  return statuses.every((_) => _);\n}\n\n/**\n * Checks if a specific WebP feature is supported\n * @param feature 'feature' can be one of 'lossy', 'lossless', 'alpha' or 'animation'.\n *\n * Based on Google's official recommended checks\n * @see https://developers.google.com/speed/webp/faq#how_can_i_detect_browser_support_for_webp\n */\nasync function checkWebPFeature(feature: WebPFeature): Promise<boolean> {\n  if (typeof Image === 'undefined') {\n    return false;\n  }\n  return await new Promise((resolve, reject) => {\n    const img = new Image();\n    img.onload = () => resolve(img.width > 0 && img.height > 0);\n    img.onerror = () => resolve(false);\n    img.src = `data:image/webp;base64,${WEBP_TEST_IMAGES[feature]}`;\n  });\n}\n"],"mappings":";;;;;;;;;AAAA,IAAMA,gBAAgB,GAAG;EACvBC,KAAK,EAAE,0DAA0D;EACjEC,QAAQ,EAAE,kDAAkD;EAC5DC,KAAK,EACH,kHAAkH;EACpHC,SAAS,EACP;AACJ,CAAC;AAID,IAAMC,aAA4B,GAAG,CAAC,OAAO,EAAE,UAAU,EAAE,OAAO,EAAE,WAAW,CAAC;AAAC,SAM3DC,eAAeA,CAAA;EAAA,OAAAC,gBAAA,CAAAC,KAAA,OAAAC,SAAA;AAAA;AAAA,SAAAF,iBAAA;EAAAA,gBAAA,OAAAG,kBAAA,CAAAC,OAAA,EAAAC,YAAA,CAAAD,OAAA,CAAAE,IAAA,CAA9B,SAAAC,QAAA;IAAA,IAAAC,QAAA;MAAAC,QAAA;MAAAC,QAAA;MAAAC,KAAA,GAAAT,SAAA;IAAA,OAAAG,YAAA,CAAAD,OAAA,CAAAQ,IAAA,UAAAC,SAAAC,QAAA;MAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;QAAA;UAA+BR,QAAuB,GAAAG,KAAA,CAAAM,MAAA,QAAAN,KAAA,QAAAO,SAAA,GAAAP,KAAA,MAAGb,aAAa;UACrEW,QAAQ,GAAGD,QAAQ,CAACW,GAAG,CAAC,UAACC,OAAO;YAAA,OAAKC,gBAAgB,CAACD,OAAO,CAAC;UAAA,EAAC;UAAAN,QAAA,CAAAE,IAAA;UAAA,OAC9CM,OAAO,CAACC,GAAG,CAACd,QAAQ,CAAC;QAAA;UAAtCC,QAAQ,GAAAI,QAAA,CAAAU,IAAA;UAAA,OAAAV,QAAA,CAAAW,MAAA,WACPf,QAAQ,CAACgB,KAAK,CAAC,UAACC,CAAC;YAAA,OAAKA,CAAC;UAAA,EAAC;QAAA;QAAA;UAAA,OAAAb,QAAA,CAAAc,IAAA;MAAA;IAAA,GAAArB,OAAA;EAAA,CAChC;EAAA,OAAAP,gBAAA,CAAAC,KAAA,OAAAC,SAAA;AAAA;AAAA,SAScmB,gBAAgBA,CAAAQ,EAAA;EAAA,OAAAC,iBAAA,CAAA7B,KAAA,OAAAC,SAAA;AAAA;AAAA,SAAA4B,kBAAA;EAAAA,iBAAA,OAAA3B,kBAAA,CAAAC,OAAA,EAAAC,YAAA,CAAAD,OAAA,CAAAE,IAAA,CAA/B,SAAAyB,SAAgCX,OAAoB;IAAA,OAAAf,YAAA,CAAAD,OAAA,CAAAQ,IAAA,UAAAoB,UAAAC,SAAA;MAAA,kBAAAA,SAAA,CAAAlB,IAAA,GAAAkB,SAAA,CAAAjB,IAAA;QAAA;UAAA,MAC9C,OAAOkB,KAAK,KAAK,WAAW;YAAAD,SAAA,CAAAjB,IAAA;YAAA;UAAA;UAAA,OAAAiB,SAAA,CAAAR,MAAA,WACvB,KAAK;QAAA;UAAAQ,SAAA,CAAAjB,IAAA;UAAA,OAED,IAAIM,OAAO,CAAC,UAACa,OAAO,EAAEC,MAAM,EAAK;YAC5C,IAAMC,GAAG,GAAG,IAAIH,KAAK,CAAC,CAAC;YACvBG,GAAG,CAACC,MAAM,GAAG;cAAA,OAAMH,OAAO,CAACE,GAAG,CAACE,KAAK,GAAG,CAAC,IAAIF,GAAG,CAACG,MAAM,GAAG,CAAC,CAAC;YAAA;YAC3DH,GAAG,CAACI,OAAO,GAAG;cAAA,OAAMN,OAAO,CAAC,KAAK,CAAC;YAAA;YAClCE,GAAG,CAACK,GAAG,6BAAAC,MAAA,CAA6BlD,gBAAgB,CAAC2B,OAAO,CAAC,CAAE;UACjE,CAAC,CAAC;QAAA;UAAA,OAAAa,SAAA,CAAAR,MAAA,WAAAQ,SAAA,CAAAT,IAAA;QAAA;QAAA;UAAA,OAAAS,SAAA,CAAAL,IAAA;MAAA;IAAA,GAAAG,QAAA;EAAA,CACH;EAAA,OAAAD,iBAAA,CAAA7B,KAAA,OAAAC,SAAA;AAAA"}